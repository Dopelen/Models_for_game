# Models, Boosts, Export

В репозитории реализовано тестовое задание с использованием SQLAlchemy для моделирования игровых процессов.

---

## Описание задания

Приложение реализует следующую логику:

1. **Ежедневный вход пользователя**:
   - Отслеживается момент первого входа игрока.
   - Начисляются очки за ежедневный вход.

2. **Игровые бонусы (бусты)**:
   - Игрок может иметь несколько типов бустов (например, удвоение очков, ускорение, щит).
   - Реализован механизм добавления бустов.

3. **Призы за уровни**:
   - Игрок получает приз за прохождение уровня.
   - Для каждого уровня есть один или несколько призов.
   - Система предотвращает дублирующую выдачу призов.

4. **Выгрузка данных в CSV**:
   - Экспортируются данные: `player_id`, `level_title`, пройден ли уровень (`completed`), название полученного приза.
   - Оптимизировано для большого объёма данных (100 000 записей и более) с использованием `yield_per` в SQLAlchemy.

---

## Структура проекта

- `main.py`: основная логика и методы
- `call_example.py`: пример запуска и проверки объектов
- `test_methods.py`: тесты функций

---

## Ключевые методы

1. **Начисление бустов игроку**  
```python
player.add_boost(session, boost_id=<boost_id>, amount=1)
```
2. **Выдача призов за уровень**
```python
player.give_prizes_for_level(session, level_id=<level_id>)
```
3. **Экспорт данных игроков и уровней в CSV**
```python
export_player_levels_to_csv(session, file_path="player_levels_export.csv")
```


### Установка зависимостей:
```python
pip install sqlalchemy pytest
```
### Запуск проверки логики из примера:
```python
python call_example.py
```
### Запуск тестов:
```python
pytest -v test_methods.py
```

## Примечания
- Для работы используется SQLite in-memory база (sqlite:///:memory:) в примерах.
В реальном приложении можно подключить любую поддерживаемую SQLAlchemy базу.
- Все связи между игроками, уровнями и призами реализованы через внешние ключи и каскадные удаления.
- Поля используемые в функциях проиндексированы
